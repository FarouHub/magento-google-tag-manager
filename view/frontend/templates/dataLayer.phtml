<?php
/**
 * @var $block DK\GoogleTagManager\Block\DataLayer
 */

use DK\GoogleTagManager\Model\DataLayer\Impressions\CatalogImpressionView;

?>

<script>
    window.dataLayer = window.dataLayer || [];

    <?php
        $data = $block->getJsonDataLayers();
        if (null !== $data): ?>

            <?php if (\in_array(CatalogImpressionView::CODE, $block->getCodes(), true)):  ?>
                window.impressions = <?= $data ?>;
            <?php else: ?>
                /** @type {Array} */
                let data = <?= /* @escapeNotVerified */ $data ?>;

                if (data.length !== 0) {
                    data.forEach((item) => {
                        dataLayer.push(item);
                    });
                }
            <?php endif; ?>

        <?php endif; ?>
</script>